* { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color:transparent; }
:root {
  --bg: #fafafa; --white: #ffffff; --black: #000000;
  --gray-1: #262626; --gray-2: #555555; --gray-3: #8e8e8e; --gray-4: #c7c7c7; --gray-5: #dbdbdb; --gray-6: #efefef;
  
  --radius: 12px; --radius-sm: 8px;
  --font: system-ui, -apple-system, 'SF Pro Text', 'Helvetica Neue', sans-serif;
}
body { font-family: var(--font); background: var(--bg); color: var(--gray-1); overflow-x: hidden; -webkit-font-smoothing: antialiased; }

/* SPLASH */
#splash {
  height:100vh; height:100dvh; display:flex; flex-direction:column; align-items:center;
  background:var(--white); cursor:pointer; position:fixed; top:0; left:0; right:0; bottom:0; z-index:999; overflow:hidden;
  transition: opacity 0.8s ease, visibility 0.8s ease;
}
#splash.hidden { opacity:0; visibility:hidden; pointer-events:none; }
.splash-bh { position:absolute; top:16px; right:16px; font-family:'Noto Serif Hebrew',serif; font-size:22px; font-weight:700; color:var(--black); direction:rtl; }
.splash-content { flex:1; display:flex; flex-direction:column; justify-content:center; align-items:center; text-align:center; padding:0 30px; max-width:440px; transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1); }
@media (max-height:700px) { .splash-content { padding-top:0; } .splash-icon .icon-770 { width:90px; } .splash-footer { padding-bottom:max(16px, env(safe-area-inset-bottom, 0px)); } }
.splash-icon { margin-bottom:12px; opacity:0; animation:scSubIn 0.5s ease 0s forwards; }
.splash-icon img { max-width:50vw; }
.splash-icon .icon-770 { width:120px; height:auto; color:var(--black); }
.splash-title { font-family:'Noto Serif Hebrew',serif; font-size:52px; color:var(--black); font-weight:700; margin-bottom:4px; direction:rtl; }
/* CHABAD ANIMATED TITLE */
.splash-title-chabad { font-size:clamp(36px, 12vw, 52px); color:var(--black); font-weight:800; margin-top:0; margin-bottom:16px; letter-spacing:2px; font-family:var(--font); display:flex; align-items:flex-end; justify-content:center; overflow:visible; line-height:1; margin-right:-2px; }
.sc-static { display:inline-block; opacity:0; animation:scFadeIn 0.4s ease forwards; line-height:1; }
.sc-apos { display:inline-block; max-width:0; opacity:0; overflow:hidden; letter-spacing:0; animation:scInsert 0.6s cubic-bezier(0.25,0.1,0.25,1) 4.1s forwards; line-height:1; }
.sc-letter-d { display:inline-block; opacity:0; animation:scD1 4.5s ease forwards; transform-origin:center 73%; position:relative; z-index:2; line-height:1; }
.sc-letter-d2 { display:inline-block; opacity:0; animation:scD2 4.5s ease forwards; transform-origin:center 73%; position:relative; z-index:1; line-height:1; }
@keyframes scFadeIn { from { opacity:0; transform:translateY(-0.23em); } to { opacity:1; transform:translateY(0); } }
@keyframes scInsert { to { max-width:0.6em; opacity:1; letter-spacing:2px; } }
/* Phase 1: D1 fades in WITH "CHABAD" (0-0.4s) */
/* Phase 2: waits while D2 emerges */
/* Phase 3: both D's rotate 180° to become P's (2.5-3.2s) */
@keyframes scD1 {
  0%   { opacity:0; transform:translateY(-0.23em) rotate(0deg); }
  9%   { opacity:1; transform:translateY(0) rotate(0deg); }
  53%  { opacity:1; transform:translateY(0) rotate(0deg); }
  69%  { opacity:1; transform:translateY(0.12em) rotate(180deg); }
  100% { opacity:1; transform:translateY(0.12em) rotate(180deg); }
}
/* Phase 1: hidden behind D1 */
/* Phase 2: slides out from D1 (1.2-2.1s) → CHABADD */
/* Phase 3: rotates with D1 to become P */
@keyframes scD2 {
  0%   { margin-left:-0.62em; opacity:0; transform:translateY(0) rotate(0deg); }
  27%  { margin-left:-0.62em; opacity:0; transform:translateY(0) rotate(0deg); }
  29%  { margin-left:-0.62em; opacity:1; transform:translateY(0) rotate(0deg); }
  47%  { margin-left:0; opacity:1; transform:translateY(0) rotate(0deg); }
  53%  { margin-left:0; opacity:1; transform:translateY(0) rotate(0deg); }
  69%  { margin-left:0; opacity:1; transform:translateY(0.12em) rotate(180deg); }
  100% { margin-left:0; opacity:1; transform:translateY(0.12em) rotate(180deg); }
}
.splash-subtitle { font-family:'Noto Serif Hebrew',serif; font-size:22px; color:var(--gray-2); letter-spacing:6px; font-weight:700; margin-bottom:28px; opacity:0; animation:scSubIn 0.8s ease 5.5s forwards; direction:rtl; }
@keyframes scSubIn { from { opacity:0; transform:translateY(8px); } to { opacity:1; transform:translateY(0); } }
.splash-divider { display:flex; align-items:center; gap:16px; justify-content:center; margin-bottom:28px; opacity:0; animation:scSubIn 0.6s ease 5.9s forwards; }
.splash-divider-line { flex:1; max-width:60px; height:1px; background:var(--gray-5); }
.splash-divider-star { color:var(--gray-4); font-size:8px; }
.splash-quote { font-style:italic; color:var(--gray-2); font-size:16px; line-height:1.7; border:none; margin:0 0 14px; padding:0 10px; min-height:80px; display:flex; align-items:center; justify-content:center; transition: opacity 0.6s ease, transform 0.6s ease; font-family:'EB Garamond',Georgia,serif; opacity:0; animation:scSubIn 0.8s ease 6.3s forwards; }
.splash-source { color:var(--gray-3); font-size:11px; letter-spacing:1.5px; font-weight:600; transition: opacity 0.6s ease; opacity:0; animation:scSubIn 0.6s ease 6.5s forwards; }
.splash-dots { display:flex; gap:6px; justify-content:center; margin-top:16px; cursor:pointer; padding:8px 0; opacity:0; animation:scSubIn 0.5s ease 6.7s forwards; }
.splash-dot { height:6px; border-radius:3px; transition: all 0.4s ease; cursor:pointer; }
.splash-tap { color:var(--gray-4); font-size:11px; margin-top:32px; letter-spacing:2px; opacity:0; animation: scSubIn 0.5s ease 6.9s forwards; }
.splash-footer { flex-shrink:0; text-align:center; padding-bottom:max(24px, env(safe-area-inset-bottom, 16px)); opacity:0; animation:scSubIn 0.5s ease 6.9s forwards; }
.footer-logo-wrap { display:inline-flex; align-items:center; gap:6px; opacity:0.7; transition:opacity 0.3s; }
.footer-logo-wrap:hover { opacity:0.9; }
.footer-logo-icon { width:28px; height:18px; }
.footer-logo-text { font-size:11px; font-weight:500; letter-spacing:1.5px; color:var(--black); font-family:var(--font); text-transform:uppercase; }
.patakh-tab { padding:8px 14px; border:1px solid var(--gray-5); border-radius:20px; background:var(--white); font-size:12px; font-weight:600; cursor:pointer; white-space:nowrap; color:var(--gray-2); transition:all 0.15s; }
.patakh-tab.active { background:var(--black); color:var(--white); border-color:var(--black); }
.patakh-he { direction:rtl; text-align:right; font-family:'Noto Serif Hebrew',serif; font-size:20px; line-height:2; color:var(--black); margin-bottom:12px; }
.patakh-ph { font-size:14px; line-height:1.8; color:var(--gray-2); font-style:italic; margin-bottom:20px; padding-bottom:16px; border-bottom:1px solid var(--gray-6); }
@keyframes pulse { 0%,100%{opacity:0.3} 50%{opacity:0.7} }

/* HOME */
#home { display:none; min-height:100vh; min-height:100dvh; background:var(--bg); padding:0 0 0; opacity:0; transition: opacity 0.6s ease; position:relative; }
#home.visible { opacity:1; }
#home > .insta-bottom-nav { position:sticky; bottom:0; }
.home-header { background:var(--white); padding:48px 16px 8px; position:relative; }
.bh-mark { position:absolute; top:16px; right:16px; font-family:'Noto Serif Hebrew',serif; font-size:22px; font-weight:700; color:var(--black); direction:rtl; }
.login-btn { position:absolute; top:16px; left:16px; background:linear-gradient(45deg,#f09433,#e6683c,#dc2743,#cc2366,#bc1888) !important; border:none !important; color:#fff !important; border-radius:20px; overflow:hidden; }
.login-btn:has(.nav-avatar) { padding:2px !important; border-radius:50% !important; background:none !important; border:1.5px solid var(--gray-4, #e5e7eb) !important; }
#panel-auth.visible { background:#fff !important; }
#home.auth-open .app-footer { display:none !important; }
.home-header-top { text-align:center; }
.app-footer { text-align:center; padding:40px 16px 32px; }
.home-greeting { font-family:var(--font); font-size:28px; font-weight:800; color:var(--black); letter-spacing:1px; text-align:center; margin-right:-1px; }
.home-badge { background:var(--gray-6); border:none; border-radius:20px; padding:6px 14px; font-size:12px; color:var(--gray-2); text-align:center; font-weight:500; }

/* PROGRESS */
.progress-section { padding:16px; }
.progress-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; }
.progress-label { font-size:12px; color:var(--gray-3); font-weight:600; }
.progress-pct { font-size:14px; color:var(--black); font-weight:700; }
.progress-track { height:2px; background:var(--gray-6); border-radius:2px; overflow:hidden; margin-bottom:6px; }
.progress-fill { height:100%; background:var(--black); border-radius:2px; transition: width 0.6s cubic-bezier(0.4,0,0.2,1); }
.progress-detail { font-size:11px; color:var(--gray-3); }

/* COMPLETE / RECAP */
.complete-card { margin:0 16px 12px; padding:16px; background:var(--white); border:1px solid var(--gray-5); border-radius:var(--radius); text-align:center; }
.complete-icon { font-size:24px; display:block; margin-bottom:4px; }
.complete-text { font-size:14px; color:var(--black); font-weight:600; }
.recap-card { margin:0 16px 12px; padding:12px; background:var(--white); border:1px solid var(--gray-5); border-radius:var(--radius); display:flex; align-items:center; gap:12px; }
.recap-icon { font-size:20px; }
.recap-title { font-size:13px; font-weight:600; color:var(--gray-1); display:block; }
.recap-sub { font-size:11px; color:var(--gray-3); }

/* NOTIFICATION */
.notif { position:fixed; top:16px; left:16px; right:16px; z-index:50; background:var(--white); border:1px solid var(--gray-5); border-radius:var(--radius); padding:12px 16px; box-shadow:0 4px 24px rgba(0,0,0,0.12); display:flex; align-items:center; gap:12px; transition: all 0.4s cubic-bezier(0.4,0,0.2,1); opacity:0; transform:translateY(-20px); }
.notif.show { opacity:1; transform:translateY(0); }
.notif-icon { font-size:18px; }
.notif-title { font-size:12px; font-weight:600; color:var(--gray-1); display:block; }
.notif-text { font-size:12px; color:var(--gray-3); }
.notif-close { background:none; border:none; font-size:16px; color:var(--gray-3); cursor:pointer; margin-left:auto; padding:4px; }

/* PSALMS LIST */
.psalms-list { padding:0 16px; }
.section-title { font-size:11px; text-transform:uppercase; letter-spacing:1px; color:var(--gray-3); font-weight:700; margin-bottom:10px; display:block; }
.psalm-card {
  width:100%; display:flex; align-items:center; justify-content:space-between;
  padding:14px 16px; margin-bottom:4px; border-radius:var(--radius); border:1px solid var(--gray-5);
  background:var(--white); cursor:pointer; font-family:inherit; font-size:inherit; transition: all 0.15s ease;
}
.psalm-card:active { background:var(--gray-6); }
.psalm-card.read { border-color:var(--black); }
.psalm-card-left { display:flex; align-items:center; gap:12px; }
.psalm-card-num { width:36px; height:36px; border-radius:50%; background:var(--gray-6); color:var(--gray-1); font-weight:700; font-size:14px; display:flex; align-items:center; justify-content:center; }
.psalm-card-num.done { background:var(--black); color:var(--white); }
.psalm-card-title { font-size:14px; font-weight:600; color:var(--gray-1); display:block; }
.psalm-card-verses { font-size:11px; color:var(--gray-3); }
.psalm-card-arrow { font-size:16px; color:var(--gray-4); }
.unavailable-card { opacity:0.5; cursor:default; pointer-events:none; }
.unavailable-num { background:var(--gray-5) !important; color:var(--gray-3) !important; }

/* HOME BIG CARDS */
.home-date-line { font-size:12px; color:var(--gray-3); text-align:center; padding:6px 16px 0; font-weight:500; }
.home-big-cards { padding:8px 16px 0; display:flex; flex-direction:column; gap:10px; }
.big-card { display:flex; align-items:center; gap:14px; padding:18px 16px; background:var(--white); border:1px solid var(--gray-5); border-radius:var(--radius); cursor:pointer; transition:all 0.15s; -webkit-tap-highlight-color:transparent; border-left:3px solid #ccc; }
.big-card:active { transform:scale(0.98); background:var(--gray-6); }
.big-card-icon { width:48px; height:48px; flex-shrink:0; border-radius:14px; display:flex; align-items:center; justify-content:center; overflow:hidden; }
.big-card-icon svg { width:36px; height:36px; }
.big-card-info { flex:1; min-width:0; }
.big-card-title { font-size:17px; font-weight:700; color:var(--black); }
.big-card-sub { font-size:12px; color:var(--gray-3); margin-top:2px; }
.big-card-arrow { font-size:24px; color:var(--gray-4); font-weight:300; flex-shrink:0; }
.home-big-cards > :nth-child(1) { border-left-color:#6228d7; }
.home-big-cards > :nth-child(2) { border-left-color:#8b2fb8; }
.home-big-cards > :nth-child(3) { border-left-color:#b43599; }
.home-big-cards > :nth-child(4) { border-left-color:#ee2a7b; }
.home-big-cards > :nth-child(5) { border-left-color:#f26a57; }
.home-big-cards > :nth-child(6) { border-left-color:#f59c42; }
.home-big-cards > :nth-child(7) { border-left-color:#f9ce34; }

/* HAYOM YOM CARD */
.hyy-card { padding:20px 18px; background:var(--white); border:1px solid var(--gray-5); border-radius:var(--radius); cursor:pointer; transition:all 0.15s; -webkit-tap-highlight-color:transparent; border-left:3px solid #ccc; }
.hyy-card:active { transform:scale(0.98); background:var(--gray-6); }
.hyy-header { display:flex; align-items:center; gap:10px; margin-bottom:12px; }
.hyy-icon { width:30px; height:30px; border-radius:8px; display:inline-flex; align-items:center; justify-content:center; flex-shrink:0; }
.hyy-icon svg { width:18px; height:18px; }
.hyy-title { font-size:14px; font-weight:700; color:var(--black); flex:1; }
.hyy-date { font-size:11px; color:var(--gray-3); font-weight:600; }
.hyy-text { font-family:'EB Garamond',Georgia,serif; font-size:15px; line-height:1.7; color:var(--gray-1); max-height:120px; overflow:hidden; transition:max-height 0.4s ease; position:relative; }
.hyy-text.expanded { max-height:2000px; }
.hyy-expand { font-size:11px; color:var(--gray-3); font-weight:600; margin-top:8px; text-align:right; }
.hyy-loading { font-size:13px; color:var(--gray-3); font-style:italic; }
.hyy-link { display:flex; align-items:center; justify-content:center; gap:6px; margin-top:12px; padding-top:10px; border-top:1px solid var(--gray-6); font-size:11px; color:var(--gray-3); font-weight:600; letter-spacing:0.5px; }
.sub-panel-header { font-size:20px; font-weight:800; color:var(--black); text-align:center; padding:8px 16px 12px; }
/* Club section */
.club-section { padding:0 0 24px; }
.club-story { padding:20px 20px 24px; text-align:center; }
.club-story-title { font-size:18px; font-weight:800; color:var(--black); margin-bottom:12px; letter-spacing:0.5px; }
.club-story-text { font-size:14px; line-height:1.7; color:var(--gray-2); margin-bottom:0; font-family:'EB Garamond',Georgia,serif; }
.club-story-tagline { font-size:12px; font-weight:700; color:var(--gray-3); letter-spacing:2px; text-transform:uppercase; margin-bottom:16px; }
.club-divider { width:40px; height:2px; background:var(--black); margin:16px auto; border-radius:1px; }
.club-products-title { font-size:14px; font-weight:700; color:var(--black); text-transform:uppercase; letter-spacing:1.5px; padding:0 20px 12px; }
.club-products { display:flex; gap:12px; padding:0 20px 20px; overflow-x:auto; -webkit-overflow-scrolling:touch; scrollbar-width:none; scroll-snap-type:x mandatory; }
.club-products::-webkit-scrollbar { display:none; }
.club-product-card { flex:0 0 160px; scroll-snap-align:start; border-radius:var(--radius); overflow:hidden; background:var(--white); border:1px solid var(--gray-6); cursor:pointer; -webkit-tap-highlight-color:transparent; transition:transform 0.2s; }
.club-product-card:active { transform:scale(0.97); }
.club-product-img { width:100%; aspect-ratio:1; object-fit:cover; background:var(--gray-6); display:block; }
.club-product-info { padding:10px 12px; }
.club-product-name { font-size:12px; font-weight:700; color:var(--black); line-height:1.3; margin-bottom:4px; display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden; }
.club-product-price { font-size:13px; font-weight:800; color:var(--black); }
.club-product-collection { font-size:10px; color:var(--gray-3); font-weight:600; margin-bottom:2px; }
.club-cta { display:block; margin:0 20px 20px; padding:14px; text-align:center; background:var(--black); color:var(--white); font-size:13px; font-weight:700; letter-spacing:1px; text-transform:uppercase; border-radius:var(--radius); text-decoration:none; transition:opacity 0.2s; }
.club-cta:active { opacity:0.85; }
.club-maasser { background:var(--gray-6); border-radius:var(--radius); margin:0 20px 20px; padding:16px; text-align:center; }
.club-maasser-emoji { font-size:24px; margin-bottom:6px; }
.club-maasser-text { font-size:12px; color:var(--gray-2); line-height:1.6; }
.club-hero { text-align:center; padding:28px 20px 20px; }
.club-hero-emoji { font-size:48px; margin-bottom:8px; }
.club-hero-title { font-size:22px; font-weight:800; color:var(--black); margin-bottom:4px; }
.club-hero-sub { font-size:13px; color:var(--gray-3); }
.club-cards { display:grid; grid-template-columns:repeat(2, 1fr); gap:10px; padding:0 16px 16px; }
.obj-story-bar { display:flex; align-items:center; gap:10px; padding:10px 12px 6px; justify-content:center; overflow-x:auto; -webkit-overflow-scrolling:touch; scrollbar-width:none; }
.obj-story-bar-scroll { justify-content:flex-start; overflow-x:auto; overflow-y:hidden; -webkit-overflow-scrolling:touch; scrollbar-width:none; gap:12px; }
.obj-story-bar-scroll::-webkit-scrollbar { display:none; }
.obj-story-bar-scroll .os-ring { width:56px; height:56px; }
.obj-story-bar-scroll .os-circle { font-size:22px; }
.obj-story-bar::-webkit-scrollbar { display:none; }
.os-item { display:flex; flex-direction:column; align-items:center; gap:4px; cursor:pointer; flex-shrink:0; -webkit-tap-highlight-color:transparent; }
.os-ring { width:64px; height:64px; border-radius:50%; display:flex; align-items:center; justify-content:center; padding:3px; transition:all 0.3s; }
.os-item.done .os-ring { background:#dbdbdb !important; }
.os-item.current .os-ring {  }
@keyframes storyPulse { 0%,100% { box-shadow:0 0 0 0 rgba(238,42,123,0.4); } 50% { box-shadow:0 0 0 8px rgba(238,42,123,0); } }
@keyframes bethPulse { 0% { transform:translate(-50%,-50%) scale(1); opacity:0.7; } 100% { transform:translate(-50%,-50%) scale(3); opacity:0; } }
#beth-map .leaflet-popup-content-wrapper { border-radius:12px; box-shadow:0 4px 16px rgba(0,0,0,0.15); }
#beth-map .leaflet-popup-tip { box-shadow:0 4px 16px rgba(0,0,0,0.1); }
#beth-map .leaflet-popup-content { margin:10px 12px; }
#beth-map .leaflet-control-zoom a { width:32px; height:32px; line-height:32px; border-radius:8px; font-size:16px; }
#beth-map .leaflet-control-zoom { border-radius:10px; overflow:hidden; box-shadow:0 2px 8px rgba(0,0,0,0.15); border:none; }
#beth-map .leaflet-control-attribution { font-size:9px; opacity:0.6; }
.os-circle { width:100%; height:100%; border-radius:50%; background:var(--white); display:flex; align-items:center; justify-content:center; font-size:24px; }
.os-label { font-size:10px; color:var(--gray-3); font-weight:600; white-space:nowrap; text-align:center; font-family:var(--font); }
.os-item.current .os-label { color:var(--black); font-weight:700; }
/* STORY OVERLAY */
#obj-story-overlay { position:fixed; top:0; left:0; right:0; bottom:0; z-index:9999; display:none; flex-direction:column; max-width:520px; margin:0 auto; }
#obj-story-overlay[style*="flex"] { display:flex !important; }
.os-progress { display:flex; gap:3px; padding:12px 8px 0; flex-shrink:0; position:absolute; top:0; left:0; right:0; z-index:10; }
.os-prog-seg { flex:1; height:2.5px; border-radius:2px; background:rgba(255,255,255,0.3); overflow:hidden; }
.os-prog-fill { height:100%; border-rad