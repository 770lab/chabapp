<!-- ============================================== -->
<!-- CHAB'APP PWA - CODE Ã€ AJOUTER DANS index.html  -->
<!-- ============================================== -->

<!-- 
  Ã‰TAPE 1 : Ajouter ces lignes dans le <head> de ton index.html
  (avant la fermeture </head>)
-->

<!-- PWA Manifest -->
<link rel="manifest" href="manifest.json">

<!-- ThÃ¨me et couleurs -->
<meta name="theme-color" content="#c9a84c">
<meta name="mobile-web-app-capable" content="yes">

<!-- Apple iOS spÃ©cifique -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Chab'app">
<link rel="apple-touch-icon" href="icons/icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="icons/icon-192x192.png">

<!-- Splash screens iOS (optionnel mais recommandÃ©) -->
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<!-- Microsoft Tile -->
<meta name="msapplication-TileColor" content="#0a0a2e">
<meta name="msapplication-TileImage" content="icons/icon-144x144.png">

<!-- Viewport (si pas dÃ©jÃ  prÃ©sent) -->
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">


<!-- 
  Ã‰TAPE 2 : Ajouter ce script AVANT la fermeture </body>
  (ou Ã  la fin de ton JavaScript existant)
-->

<script>
// ===== Enregistrement du Service Worker =====
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('sw.js')
      .then((registration) => {
        console.log('âœ… Service Worker enregistrÃ© avec succÃ¨s:', registration.scope);
      })
      .catch((error) => {
        console.log('âŒ Erreur Service Worker:', error);
      });
  });
}

// ===== Bouton d'installation PWA =====
let deferredPrompt;

window.addEventListener('beforeinstallprompt', (e) => {
  // EmpÃªcher le mini-infobar Chrome par dÃ©faut
  e.preventDefault();
  deferredPrompt = e;
  
  // Afficher ton propre bouton d'installation
  showInstallButton();
});

function showInstallButton() {
  // CrÃ©er un bouton d'installation flottant
  const btn = document.createElement('div');
  btn.id = 'pwa-install-btn';
  btn.innerHTML = `
    <div style="
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: linear-gradient(135deg, #c9a84c, #e8d48b);
      color: #0a0a2e;
      padding: 14px 28px;
      border-radius: 50px;
      font-family: inherit;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 4px 20px rgba(201, 168, 76, 0.5);
      z-index: 10000;
      display: flex;
      align-items: center;
      gap: 8px;
      animation: slideUp 0.5s ease-out;
    ">
      ðŸ“² Installer Chab'app
    </div>
  `;
  
  // Ajouter l'animation
  const style = document.createElement('style');
  style.textContent = `
    @keyframes slideUp {
      from { transform: translateX(-50%) translateY(100px); opacity: 0; }
      to { transform: translateX(-50%) translateY(0); opacity: 1; }
    }
  `;
  document.head.appendChild(style);
  document.body.appendChild(btn);
  
  btn.addEventListener('click', async () => {
    if (deferredPrompt) {
      deferredPrompt.prompt();
      const { outcome } = await deferredPrompt.userChoice;
      console.log(outcome === 'accepted' ? 'âœ… App installÃ©e !' : 'âŒ Installation refusÃ©e');
      deferredPrompt = null;
      btn.remove();
    }
  });
}

// Masquer le bouton si dÃ©jÃ  installÃ©
window.addEventListener('appinstalled', () => {
  console.log('âœ… Chab\'app installÃ©e avec succÃ¨s !');
  const btn = document.getElementById('pwa-install-btn');
  if (btn) btn.remove();
  deferredPrompt = null;
});
</script>
